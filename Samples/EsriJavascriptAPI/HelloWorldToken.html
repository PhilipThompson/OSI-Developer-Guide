<!doctype html>
<html>
<head>
    <title>Esri Javascript API Hello World OSI Token Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1,user-scalable=no">
    <meta name="author" content="Philip Thompson">
    <link rel="stylesheet" href="http://js.arcgis.com/3.6/js/esri/css/esri.css">
    <script>        var dojoConfig = { parseOnLoad: true }; </script>
    <script src="http://js.arcgis.com/3.6/"></script>
    <script>
        dojo.require("esri.map");
        dojo.require("esri.layers.ArcGISTiledMapServiceLayer");

        var map;

        function init() {
            map = new esri.Map("map");

            var osiMap = new esri.layers.ArcGISTiledMapServiceLayer("https://webservices.osi.ie/ArcGIS/rest/services/ITM/MapGenie_Basemap_ITM/MapServer?token=xS675AT6-RK3stk_oA8P4kKV7Wun42jtHx4JuxLfKrOWHrQ_P-8RQ6jOVTSecUGO-vBY4x8Ys8Ygz9rzHnhwMA..");
            map.addLayer(osiMap);

            dojo.connect(osiMap, "onLoad", layerLoaded); 
        }

        var theExtentConnect;
        function layerLoaded() {
            debugger;
            var point = new esri.geometry.Point(-6.3386, 53.36151, new esri.SpatialReference({ wkid: 4326 }))
            //map.centerAndZoom(point, 13);
            dojo.connect(map, "onExtentChange", zoomToLevel);
            map.centerAt(point);
        }

        function zoomToLevel() {
            debugger;
            //map.setLevel(2);
            //dojo.disconnect(theExtentConnect);
        }
 
        //show map on load 
        dojo.ready(init);
    </script>
</head>
<body>
    <div id="map" style="width: 600px; height: 400px"></div>
</body>
</html>
